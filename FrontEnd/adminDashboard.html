<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Easy Car Rental Service / Admin</title>
  <link rel="stylesheet" href="assets/css/bootstrap.min.css">
  <script src="https://kit.fontawesome.com/97dbc65e21.js" crossorigin="anonymous"></script>

  <style>
    *{
      scroll-behavior: smooth;
      transition: all 1s;
    }

    #dashboardPage{
      display: block;
    }

    #carPage{
      display: none;
    }

    #driverPage{
      display: none;
    }

    #customerPage{
      display: none;
    }

    tr{
      cursor: pointer;
    }

    tr:hover{
      background: #ffc107;
    }


  </style>

</head>
<body>
<!--navBar-->
<nav class="navbar shadow-sm navbar-expand-lg navbar-light bg-warning">
  <div class="container">
    <a class="navbar-brand" href="#"><img src="assets/images/LogoBlack.png" width="200" alt=""></a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarText">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item active">
          <a class="nav-link" id="dashboardNav" href="#">Dashboard</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="carsNav" href="#">Cars</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" id="customersNav">Customers</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" id="driversNav">Drivers</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Income</a>
        </li>
      </ul>
      <span class="navbar-text">
                <i class="fa-solid fa-user"></i>
                Administrator
            </span>
    </div>
  </div>
</nav>

<!--Dashboard-->
<div id="dashboardPage">
<div class="container">
<div class="mt-md-4 mb-md-4">
  <h1>Dashboard</h1>
<div class="row">
  <div class="col-md-3">
    <div class="card shadow text-dark bg-warning mb-3">
      <div class="card-body">
        <h5 class="card-title">Cars</h5>
        <h1 class="display-4"><strong>30</strong></h1>
        <i class="fa-solid fa-car  display-4 d-flex justify-content-end"></i>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card shadow text-dark bg-warning mb-3">
      <div class="card-body">
        <h5 class="card-title">Customers</h5>
        <h1 class="display-4"><strong>18</strong></h1>
        <i class="fa-solid fa-user  display-4 d-flex justify-content-end"></i>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card shadow text-dark bg-warning mb-3">
      <div class="card-body">
        <h5 class="card-title">Drivers</h5>
        <h1 class="display-4"><strong>15</strong></h1>
        <i class="fa-solid fa-person  display-4 d-flex justify-content-end"></i>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card shadow text-dark bg-warning mb-3">
      <div class="card-body">
        <h5 class="card-title">Bookings</h5>
        <h1 class="display-4"><strong>03</strong></h1>
        <i class="fa-solid fa-plus  display-4 d-flex justify-content-end"></i>
      </div>
    </div>
  </div>
</div>
  </div>

<!--  booking table-->
  <div>
    <table class="table shadow">
      <thead class="thead-dark">
      <tr>
        <th scope="col">ID</th>
        <th scope="col">Customer</th>
        <th scope="col">Start Date</th>
        <th scope="col">End Date</th>
        <th scope="col">Total</th>
        <th scope="col">Option</th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <th scope="row">BK001</th>
        <td>Saman</td>
        <td>2023-02-15</td>
        <td>2023-03-15</td>
        <td>34000</td>
        <td><button class="btn-sm btn-danger mr-1">Cancel</button><button class="btn-sm btn-success">Approve</button></td>
      </tr>
      <tr>
        <th scope="row">BK002</th>
        <td>Kamal</td>
        <td>2023-02-16</td>
        <td>2023-03-15</td>
        <td>34000</td>
        <td><button class="btn-sm btn-danger mr-1">Cancel</button><button class="btn-sm btn-success">Approve</button></td>
      </tr>
      <tr>
        <th scope="row">BK003</th>
        <td>Yomal</td>
        <td>2023-02-17</td>
        <td>2023-03-15</td>
        <td>34000</td>
        <td><button class="btn-sm btn-danger mr-1">Cancel</button><button class="btn-sm btn-success">Approve</button></td>
      </tr>
      </tbody>
    </table>
  </div>
</div>
</div>

<!--Car Management-->
<div id="carPage">
<div class="container">
<div class="mt-md-4 mb-md-4">
  <h1>Cars</h1>
  <div class="row">
    <div class="col">
      <form id="formCar">
        <div class="row mt-4">
          <div class="col">
            <label for="cr_reg">Reg Number</label>
            <input type="text" class="form-control" id="cr_reg" name="cr_reg" placeholder="ABC-1234">
          </div>
          <div class="col">
            <label for="cr_make">Make</label>
            <input type="text" class="form-control" id="cr_make" name="cr_make" placeholder="Toyota, Suzuki, Honda">
          </div>
          <div class="col">
            <label for="cr_model">Model</label>
            <input type="text" class="form-control" id="cr_model" name="cr_model" placeholder="Vitz, Lancer">
          </div>
        </div>
        <div class="row mt-4">
          <div class="col">
            <label for="cr_fuel">Fuel Type</label>
            <select class="form-control" id="cr_fuel" name="cr_fuel">
              <option value="Petrol">Petrol</option>
              <option value="Diesel">Diesel</option>
              <option value="Hybrid">Hybrid</option>
              <option value="Electric">Electric</option>
            </select>
          </div>
          <div class="col">
            <label for="cr_type">Category</label>
            <select class="form-control" id="cr_type" name="cr_type">
              <option value="General">General</option>
              <option value="Premium">Premium</option>
              <option value="Luxury">Luxury</option>
            </select>
          </div>
        </div>
        <div class="form-group row mt-4">
          <div class="col">
            <label for="cr_day">Price per Day</label>
            <input type="text" class="form-control" id="cr_day" name="cr_day" placeholder="Rs:">
          </div>
          <div class="col">
            <label for="cr_month">Month</label>
            <input type="text" class="form-control" id="cr_month" name="cr_month" placeholder="Rs:">
          </div>
          <div class="col">
            <label for="cr_km">Extra Km</label>
            <input type="text" class="form-control" id="cr_km" name="cr_km" placeholder="Rs:">
          </div>
        </div>
        <div class="form-group row mt-4">
          <div class="col">
            <label for="txtCar_rangeDay">Range per Day</label>
            <input type="text" class="form-control" id="txtCar_rangeDay" name="txtCar_rangeDay" placeholder="Km:">
          </div>
          <div class="col">
            <label for="cr_rangeMonth">Range per Month</label>
            <input type="text" class="form-control" id="cr_rangeMonth" name="cr_rangeMonth" placeholder="Km:">
          </div>
        </div>
        <div class="form-group row mt-4">
          <div class="col">
            <label for="cr_img">Car Image</label>
            <input type="file" class="form-control-file" id="cr_img" name="cr_img">
          </div>
          <div class="col-3">
            <button class="btn btn-success" type="button" id="btnSaveCar">Save</button>
            <button class="btn btn-warning" type="button" id="btnUpdateCar">Update</button>
            <button class="btn btn-danger" type="button" id="btnDeleteCar">Delete</button>
          </div>
        </div>
      </form>

    </div>
  </div>


  <div class="row">
    <!--  Car table-->
    <div class="col">
      <table class="table shadow">
        <thead class="thead-dark">
        <tr>
          <th scope="col">RegNo</th>
          <th scope="col">Image</th>
          <th scope="col">Make</th>
          <th scope="col">Model</th>
          <th scope="col">Type</th>
          <th scope="col">Fuel</th>
          <th scope="col">NoPas</th>
          <th scope="col">Day/Rs</th>
          <th scope="col">Month/Rs</th>
          <th scope="col">Km/Rs</th>
          <th scope="col">Avail</th>
        </tr>
        </thead>
        <tbody id="tblCar">
        <tr>
          <td>KL-1234</td>
          <td><img src="assets/images/Genaral/alto-m/1.png" width="100" alt="1234"></td>
          <td>Suzuki</td>
          <td>Alto</td>
          <td>Luxury</td>
          <td>Petrol</td>
          <td>4</td>
          <td>2400</td>
          <td>62000</td>
          <td>100</td>
          <td class="text-success">Yes</td>
        </tr>
        <tr>
          <td>KL-6245</td>
          <td><img src="assets/images/Genaral/alto-m/2.png" width="100"  alt="1234"></td>
          <td>Suzuki</td>
          <td>Alto</td>
          <td>Premium</td>
          <td>Diesel</td>
          <td>4</td>
          <td>2400</td>
          <td>62000</td>
          <td>100</td>
          <td class="text-success">Yes</td>
        </tr>
        <tr>
          <td>KL-3244</td>
          <td><img src="assets/images/Genaral/alto-m/3.png" width="100"  alt="1234"></td>
          <td>Suzuki</td>
          <td>Alto</td>
          <td>General</td>
          <td>Petrol</td>
          <td>4</td>
          <td>2400</td>
          <td>62000</td>
          <td>100</td>
          <td class="text-danger">No</td>
        </tr>
        <tr>
          <td>KL-3244</td>
          <td><img src="assets/images/Genaral/alto-m/4.png" width="100"  alt="1234"></td>
          <td>Bmw</td>
          <td>Alto</td>
          <td>General</td>
          <td>Petrol</td>
          <td>4</td>
          <td>2400</td>
          <td>62000</td>
          <td>100</td>
          <td class="text-success">Yes</td>
        </tr>
        <tr>
          <td>KL-3244</td>
          <td><img src="assets/images/Genaral/alto-m/5.png" width="100"  alt="1234"></td>
          <td>Suzuki</td>
          <td>Alto</td>
          <td>General</td>
          <td>Petrol</td>
          <td>4</td>
          <td>2400</td>
          <td>62000</td>
          <td>100</td>
          <td class="text-success">Yes</td>
        </tr>
        <tr>
          <td>KL-3244</td>
          <td><img src="assets/images/Genaral/alto-m/6.png" width="100"  alt="1234"></td>
          <td>Suzuki</td>
          <td>Alto</td>
          <td>General</td>
          <td>Petrol</td>
          <td>4</td>
          <td>2400</td>
          <td>62000</td>
          <td>100</td>
          <td class="text-success">Yes</td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
</div>
</div>

<!--Customer Management-->
<div id="customerPage">
  <div class="container">
    <div class="mt-md-4 mb-md-4">
      <h1>Customers</h1>
      <div class="row ">
        <div class="col-5">
          <form id="fromCustomer">
            <div class="form-group">
              <label for="cus_nic">NIC Number:</label>
              <input type="text" class="form-control" id="cus_nic" name="cus_nic" required>
            </div>
            <div class="form-group">
              <label for="cus_name">Name:</label>
              <input type="text" class="form-control" id="cus_name" name="cus_name" required>
            </div>
            <div class="form-group">
              <label for="cus_address">Address:</label>
              <input type="text" class="form-control" id="cus_address" name="cus_address" required>
            </div>
            <div class="row">
              <div class="col form-group">
                <label for="cus_contact">Contact Number:</label>
                <input type="text" class="form-control" id="cus_contact" name="cus_contact" required>
              </div>
              <div class="col form-group">
              <label for="cus_email">Email:</label>
              <input type="email" class="form-control" id="cus_email" name="cus_email" required>
            </div></div>

            <div class="form-group">
              <label for="cus_img">NIC Image:</label>
              <input type="file" class="form-control-file" id="cus_img" name="cus_img" accept="image/*" required>
            </div>
            <button type="button" class="btn btn-success" id="btnSaveCus">Save</button>
            <button type="button" class="btn btn-warning" id="btnUpdateCus">Update</button>
            <button type="button" class="btn btn-danger" id="btnDeleteCus">Remove</button>
          </form>
        </div>



        <!--  Customer table-->
        <div class="col-7">
          <table class="table shadow">
            <thead class="thead-dark">
            <tr>
              <th scope="col">NIC</th>
              <th scope="col">Name</th>
              <th scope="col">Address</th>
              <th scope="col">Contact</th>
              <th scope="col">Email</th>
            </tr>
            </thead>
            <tbody id="tblCustomer">
            <tr>
              <td>200113203389</td>
              <td>Saman Kumara</td>
              <td>721/C, Galle</td>
              <td>0788899144</td>
              <td>contact@gmail.com</td>
            </tr>
            <tr>
              <td>20014123403389</td>
              <td>Gayan Withana</td>
              <td>Colombo</td>
              <td>0721345687</td>
              <td>contact@gmail.com</td>
            </tr>
            <tr>
              <td>20014123403389</td>
              <td>Gayan Withana</td>
              <td>Colombo</td>
              <td>0721345687</td>
              <td>contact@gmail.com</td>
              <td><img src="assets/images/bg.jpg"  width="200"></td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="row">
        <div id="display">

        </div>
      </div>
    </div>
  </div>
</div>

<!--Driver Management-->
<div id="driverPage">
  <div class="container">
    <div class="mt-md-4 mb-md-4">
      <h1>Drivers</h1>
      <div class="row ">
        <div class="col-4">
          <form id="formDriver">
            <div class="row mt-4">
              <div class="col">
                <label for="dr_lic">License Number</label>
                <input type="text" class="form-control" id="dr_lic" name="dr_lic" placeholder="B12345678">
              </div>
              <div class="col">
                <label for="dr_name">Name</label>
                <input type="text" class="form-control" id="dr_name" name="dr_name" placeholder="Pasan Kumara">
              </div>
            </div>
            <div class="row mt-4">
              <div class="col">
                <label for="dr_contact">Contact Number</label>
                <input type="text" class="form-control" id="dr_contact" name="dr_contact" placeholder="0712345678">
              </div>
              <div class="col">
                <label for="dr_avail">Availability</label>
                <select class="form-control" id="dr_avail" name="dr_avail">
                <option value="Yes">Yes</option>
                <option value="No">No</option>
              </select>

              </div>
            </div>
            <div class="form-group row mt-4">
              <div class="col">
                <button class="btn btn-success" type="button" id="btnSaveDr" >Save</button>
                <button class="btn btn-warning" id="btnUpdateDr" >Update</button>
                <button class="btn btn-danger" id="btnDeleteDr" >Delete</button>
              </div>
            </div>
          </form>

        </div>



        <!--  Driver table-->
        <div class="col-8">
          <table class="table shadow">
            <thead class="thead-dark">
            <tr>
              <th scope="col">License Number</th>
              <th scope="col">Name</th>
              <th scope="col">Contact</th>
              <th scope="col">Availability</th>
            </tr>
            </thead>
            <tbody id="tblDriver">
            <tr>
              <td>B3203389</td>
              <td>Saman Kumara</td>
              <td>0788899144</td>
              <td>Yes</td>
            </tr>
            <tr>
              <td>B1324568</td>
              <td>Sadun Widuranga</td>
              <td>0713284658</td>
              <td>No</td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="assets/js/jquery-3.6.1.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>

<script>

  let baseURL = "http://localhost:8080/BackEnd_war/"

  $("#dashboardNav").click(function (){
    $("#dashboardPage").css("display" , "block");
    $("#carPage").css("display", "none");
    $("#customerPage").css("display", "none");
    $("#driverPage").css("display", "none");
  });

  $("#carsNav").click(function (){
    $("#dashboardPage").css("display" , "none");
    $("#carPage").css("display", "block");
    $("#customerPage").css("display", "none");
    $("#driverPage").css("display", "none");
  });

  $("#customersNav").click(function (){
    $("#dashboardPage").css("display" , "none");
    $("#carPage").css("display", "none");
    $("#customerPage").css("display", "block");
    $("#driverPage").css("display", "none");
  });

  $("#driversNav").click(function (){
    $("#dashboardPage").css("display" , "none");
    $("#carPage").css("display", "none");
    $("#customerPage").css("display", "none");
    $("#driverPage").css("display", "block");
  });

    $("#tblCustomer>tr").click(function () {
      let cusNic = $(this).children(":eq(0)").text();
      let cusName = $(this).children(":eq(1)").text();
      let cusAddress = $(this).children(":eq(2)").text();
      let cusContact = $(this).children(":eq(3)").text();
      let cusEmail = $(this).children(":eq(4)").text();

      $('#cus_nic').val(cusNic);
      $('#cus_name').val(cusName);
      $('#cus_address').val(cusAddress);
      $('#cus_contact').val(cusContact);
      $('#cus_email').val(cusEmail);
    });

    $("#tblCar>tr").click(function (){
      let carReg = $(this).find("td:eq(0)").text();
      let carMake =$(this).find("td:eq(2)").text();
      let carModel = $(this).find("td:eq(3)").text();
      let carType = $(this).find("td:eq(4)").text();
      let carFuel = $(this).find("td:eq(5)").text();
      let carPas = $(this).find("td:eq(6)").text();
      let carDay = $(this).find("td:eq(7)").text();
      let carMonth = $(this).find("td:eq(8)").text();
      let carKm = $(this).find("td:eq(9)").text();

      $('#cr_reg').val(carReg);
      $('#cr_make').val(carMake);
      $('#cr_model').val(carModel);
      $('#cr_type').val(carType);
      $('#cr_fuel').val(carFuel);
      $('#cr_day').val(carDay);
      $('#cr_month').val(carMonth);
      $('#cr_km').val(carKm);

      console.log(carType);
    });

  $("#tblDriver>tr").click(function () {
    let drLic = $(this).find("td:eq(0)").text();
    let drName = $(this).find("td:eq(1)").text();
    let drContact = $(this).find("td:eq(2)").text();
    let drAvail = $(this).find("td:eq(3)").text();


    $('#dr_lic').val(drLic);
    $('#dr_name').val(drName);
    $('#dr_contact').val(drContact);
    $('#dr_avail').val(drAvail);

  });

  // Driver
  $("#btnSaveDr").click(function (){
    let formDrData = $("#formDriver").serialize();

    $.ajax({
      url: baseURL+"driver",
      method:"post",
      data: formDrData,
      dataType: "json",
      success: function (res){
        alert(res.state+" : "+res.message);
        console.log("Success : "+res.message)
        // uploadimg();
      },
      error: function (err){
        alert(err.state+" : "+err.message);
        console.log("Error : "+err.message)
      }
    });
  });

  //Customer
  $("#btnSaveCus").click(function (){
    let formCusData = $("#fromCustomer").serialize();

    let cus_nic = $("#cus_nic").val();
    let cus_name = $("#cus_name").val();
    let cus_address = $("#cus_address").val();
    let cus_contact = $("#cus_contact").val();
    let cus_email = $("#cus_email").val();

    let file = $("#cus_img")[0].files[0];

    var formData = new FormData();

    formData.append('cus_nic', cus_nic);
    formData.append('cus_name', cus_name);
    formData.append('cus_address', cus_address);
    formData.append('cus_contact', cus_contact);
    formData.append('cus_email', cus_email);
    formData.append('cus_img', file);

    console.log(cus_nic);

    $.ajax({
      url: baseURL+"customer",
      method: 'post',
      processData: false,
      contentType: false,
      data: formData,
      success: function (res){
        alert("Success : "+res.message);
        console.log("Success : "+res.message);
        getAllCustomers();
      },
      error: function (err){
        let message = JSON.parse(err.responseText).message;
        alert(message);
        console.log("Error : "+message)
        getAllCustomers();
      }
    });
  });

  $("#btnDeleteCus").click(function (){
    let cus_nic = $("#cus_nic").val();
    console.log(cus_nic);
    $.ajax({
      url: baseURL+"customer",
      method:"delete",
      data: cus_nic,
      dataType: "json",
      success: function (res){
        alert("Success "+res.toString());
        console.log("Success : "+res)
        getAllCustomers();
      },
      error: function (err){
        alert("Error" +err.toString());
        console.log("Error : "+err)
        getAllCustomers();
      }
    });
  });



  function getAllCustomers() {
    $("#tblCustomer").empty();
    $.ajax({
      url: baseURL+"customer",
      method: 'get',
      dataType: 'json',
      success: function (res) {
        for (let c of res.data) {
          let cusNic = c.cus_nic;
          let cusName = c.cus_name;
          let cusAddress = c.cus_address;
          let cusContact = c.cus_contact;
          let cusEmail = c.cus_email;
          let cusImg = c.cus_img;

          $("#display").css({
            "background": `url(${baseURL + cusImg})`,
            "background-size": "cover",
            "height": "300px"
          });

          // console.log(res.data +" : "+cusImg);
          //
          // let row =  "<tr><td>" + cusNic + "</td><td>" + cusName + "</td><td>" + cusAddress + "</td><td>" + cusContact + "</td><td>" + cusEmail + "</td><td> <img src='${baseUrl + res}' width='100'> </td></tr>";
          //
          // $("#tblCustomer").append(row);
        }

      },
      error: function (error) {
        let message = JSON.parse(error.responseText).message;
        alert(message);
      }
    });
  }


  //Car
  $("#btnSaveCar").click(function (){
    var formData = new FormData();

    formData.append('cr_reg', cr_reg);
    formData.append('cr_make', cr_make);
    formData.append('cr_model', cr_model);
    formData.append('cr_type', cr_type);
    formData.append('cr_fuel', cr_fuel);
    formData.append('cr_nfp', cr_nfp);
    formData.append('cr_day', cr_day);
    formData.append('cr_month', cr_month);
    formData.append('cr_km', cr_km);
    formData.append('cr_avail', "Yes");
    formData.append('cr_img', cr_img);
    $.ajax({
      url: baseURL+"car",
      method:"post",
      data: formCarData,
      dataType: "json",
      success: function (res){
        alert("Success "+res.toString());
        console.log("Success : "+res)
      },
      error: function (err){
        alert("Error" +err.toString());
        console.log("Error : "+err)
      }
    });
  });



</script>
</body>
</html>